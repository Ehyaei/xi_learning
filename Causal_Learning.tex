% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
  10pt,
]{article}
\usepackage{amsmath,amssymb}
\usepackage{lmodern}
\usepackage{setspace} % add line to default template
\setstretch{1.2}      % add line to default template
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\hypersetup{
  pdftitle={Causal Learning},
  pdfauthor={Ahmad Ehyaei},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}
\urlstyle{same} % disable monospaced font for URLs
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering
\ifLuaTeX
  \usepackage{selnolig}  % disable illegal ligatures
\fi

\title{Causal Learning}
\usepackage{etoolbox}
\makeatletter
\providecommand{\subtitle}[1]{% add subtitle to \maketitle
  \apptocmd{\@title}{\par {\large #1 \par}}{}{}
}
\makeatother
\subtitle{Tubingen University}
\author{Ahmad Ehyaei}
\date{}

% ...................................................................... %
%
%               Add MPI Custom Template For Long Reprt
%
% ...................................................................... %
\usepackage{float}

% ...................................................................... %
% Load Packages
% tables requirement kableExtra packages2
% TODO: table striped dont work

% ...................................................................... %
% Add MPI Colors

% Colors extract from Max-Planck Society CD Manula
% https://docplayer.org/2328711-Max-planck-institut-das-erscheinungsbild-der-max-planck-gesellschaft-4-ueberarbeitete-auflage.html
\usepackage{xcolor}

\definecolor{MPIGreen}{HTML}{116656}
\definecolor{MPIGray}{HTML}{DDDED6}
\definecolor{MPIBlue}{HTML}{009EE2}
\definecolor{MPIRed}{HTML}{E90649}
\definecolor{MPILightBlue}{HTML}{40BDE8}
\definecolor{MPIOrange}{HTML}{FF7300}
\definecolor{MPIYellow}{HTML}{FFCE09}
\definecolor{MPIPink}{HTML}{FA9FCC}
\definecolor{MPILightGreen}{HTML}{62BD19}
\definecolor{MPILivingCoral}{HTML}{FC766A}
\definecolor{MPIPacificCoast}{HTML}{5B84B1}

% set titlepage top, bottom, text and rule color

\definecolor{titlepageTopColor}{HTML}{DDDED6}


\definecolor{titlepageBottomColor}{HTML}{009EE2}


\definecolor{titlepageTextColor}{HTML}{0085b2}

\definecolor{titlepageAuthorTextColor}{HTML}{0085b2}


\definecolor{titlePageColor}{HTML}{009EE2}

\definecolor{titlePageRuleColor}{HTML}{ffffff}

\definecolor{pageBackgroundColor}{HTML}{ffffff}

\definecolor{bannerColor}{HTML}{40BDE8}

\definecolor{bannerTextColor}{HTML}{000000}

\definecolor{chapterTitleColor}{HTML}{0085b2}

% Set Initial Values

\def\titlepageRuleHeight{10}


\def\titleVjust{-100}

\def\titleHjust{30}


\def\authorVjust{-320}

\def\authorHjust{30}


\def\logoPrimarySize{0.126}

\def\logoSecondarySize{0.126}


\def\logoSecondaryVjust{-320}

\def\logoSecondaryHjust{220}

\def\bannerLogoSize{0.06}


% end of color and value definition
%......................................................................%

%......................................................................%
% set default hold position of figure and table
\makeatletter
  \providecommand*\setfloatlocations[2]{\@namedef{fps@#1}{#2}}
\makeatother
\setfloatlocations{figure}{H}
\setfloatlocations{table}{H}
%......................................................................%


%......................................................................%
% Add Main Fonts

\usepackage{fontspec}
% set main font univers
\setmainfont[ Path = src/fonts/]{Univers-light-normal.ttf}[
BoldFont = UniversBlack.ttf,
ItalicFont = UniversLTStd.otf,
BoldItalicFont = UniversLTStd-Bold.otf
]
% define Bodoni font for title
% \newfontfamily\Aleo[
%   Path=src/fonts/,
%   LetterSpace=2.0,
%   WordSpace={10,0,0},
%   HyphenChar=None,
%   PunctuationSpace=WordSpace
%   ]{src/fonts/Aleo-Bold.otf}
% \newfontfamily\Aleo[Path=src/fonts/]{Aleo-Bold.otf}
% \newfontfamily\BodoniBoldItalic[Path=src/fonts/]{BodoniFLF-BoldItalic.ttf}
% \newfontfamily\BodoniItalic[Path=src/fonts/]{BodoniFLF-Italic.ttf}


%......................................................................%
% add colored box environments

\usepackage[most]{tcolorbox}
\usepackage{awesomebox}

\newtcolorbox{info-box}{colback=cyan!5!white,arc=0pt,outer arc=0pt,colframe=cyan!60!black}
\newtcolorbox{warning-box}{colback=orange!5!white,arc=0pt,outer arc=0pt,colframe=orange!80!black}
\newtcolorbox{error-box}{colback=red!5!white,arc=0pt,outer arc=0pt,colframe=red!75!black}


% Think
\newenvironment{rmdThink}{
	\vspace*{0.5\baselineskip}
    \par\noindent
    \begin{tcolorbox}[enhanced, title={\textbf{\color{white}Think}},colback=MPIGreen!10!white, colframe=MPIGreen]
    \itshape
}{
    \end{tcolorbox}
    \par\ignorespacesafterend
}
\newtcolorbox{rmdthink}{colback=MPIGreen!10!white,colframe=MPIGreen,coltext=black,leftrule= 2mm,rightrule=0.5mm,bottomrule=0.5mm,toprule=0.5mm, boxsep=0.5pt,arc=2pt}

% Note
\newenvironment{rmdNote}{
	\vspace*{0.5\baselineskip}
    \par\noindent
    \begin{tcolorbox}[enhanced, title={\textbf{\color{white}Note}},colback=MPIRed!10!white, colframe=MPIRed]
    \itshape
}{
    \end{tcolorbox}
    \par\ignorespacesafterend
}
\newtcolorbox{rmdnote}{colback=MPIRed!10!white,colframe=MPIRed,coltext=black,leftrule= 2mm,rightrule=0.5mm,bottomrule=0.5mm,toprule=0.5mm, boxsep=0.5pt,arc=2pt}

% Tip
\newenvironment{rmdTip}{
	\vspace*{0.5\baselineskip}
    \par\noindent
    \begin{tcolorbox}[enhanced, title={\textbf{\color{white}Tip}},colback=MPILightGreen!10!white, colframe=MPILightGreen]
    \itshape
}{
    \end{tcolorbox}
    \par\ignorespacesafterend
}
\newtcolorbox{rmdtip}{colback=MPILightGreen!10!white,colframe=MPILightGreen,coltext=black,leftrule= 2mm,rightrule=0.5mm,bottomrule=0.5mm,toprule=0.5mm, boxsep=0.5pt,arc=2pt}

% warning
\newenvironment{rmdWarning}{
	\vspace*{0.5\baselineskip}
    \par\noindent
    \begin{tcolorbox}[enhanced, title={\textbf{\color{white}Warning}},colback=MPIOrange!10!white, colframe=MPIOrange]
    \itshape
}{
    \end{tcolorbox}
    \par\ignorespacesafterend
}
\newtcolorbox{rmdwarning}{colback=MPIOrange!10!white,colframe=MPIOrange,coltext=black,leftrule= 2mm,rightrule=0.5mm,bottomrule=0.5mm,toprule=0.5mm, boxsep=0.5pt,arc=2pt}

% todo
\newenvironment{rmdTodo}{
	\vspace*{0.5\baselineskip}
    \par\noindent
    \begin{tcolorbox}[enhanced, title={\textbf{\color{white}To Do}},colback=MPIBlue!10!white, colframe=MPIBlue]
    \itshape
}{
    \end{tcolorbox}
    \par\ignorespacesafterend
}
\newtcolorbox{rmdtodo}{colback=MPIBlue!10!white,colframe=MPIBlue,coltext=black,leftrule= 2mm,rightrule=0.5mm,bottomrule=0.5mm,toprule=0.5mm, boxsep=0.5pt,arc=2pt}



\newtcbtheorem[auto counter,number within=section]{Theorem}{Theorem}{%
                lower separated=false,fonttitle=\bfseries,
                colback=MPIGreen!10!white,colframe=MPIGreen,
                colbacktitle=MPIGreen, coltitle=white,
                enhanced,attach boxed title to top left={xshift=0.5cm,yshift=-2mm}
                }{thm}

\newtcbtheorem[auto counter,number within=section]{Definition}{Definition}{%
                lower separated=false,fonttitle=\bfseries,
                colback=MPILightGreen!10!white,colframe=MPILightGreen,
                colbacktitle=MPILightGreen, coltitle=white,
                enhanced,attach boxed title to top left={xshift=0.5cm,yshift=-2mm}
                }{defn}

\newtcbtheorem[auto counter,number within=section]{Lemma}{Lemma}{%
                lower separated=false,fonttitle=\bfseries,
                colback=MPILightBlue!10!white,colframe=MPILightBlue,
                colbacktitle=MPILightBlue, coltitle=white,
                enhanced,attach boxed title to top left={xshift=0.5cm,yshift=-2mm}
                }{lem}

\newtcbtheorem[auto counter,number within=section]{Corollary}{Corollary}{%
                lower separated=false,fonttitle=\bfseries,
                colback=MPIBlue!10!white,colframe=MPIBlue,
                colbacktitle=MPIBlue, coltitle=white,
                enhanced,attach boxed title to top left={xshift=0.5cm,yshift=-2mm}
                }{cor}

\newtcbtheorem[auto counter,number within=section]{Proposition}{Proposition}{%
                lower separated=false,fonttitle=\bfseries,
                colback=MPIYellow!10!white,colframe=MPIYellow,
                colbacktitle=MPIYellow, coltitle=white,
                enhanced,attach boxed title to top left={xshift=0.5cm,yshift=-2mm}
                }{prop}

\newtcbtheorem[auto counter,number within=section]{Exercise}{Exercise}{%
                lower separated=false,fonttitle=\bfseries,
                colback=MPIRed!10!white,colframe=MPIRed,
                colbacktitle=MPIRed, coltitle=white,
                enhanced,attach boxed title to top left={xshift=0.5cm,yshift=-2mm}
                }{exer}

\newtcbtheorem[auto counter,number within=section]{Example}{Example}{%
                lower separated=false,fonttitle=\bfseries,
                colback=MPIOrange!10!white,colframe=MPIOrange,
                colbacktitle=MPIOrange, coltitle=white,
                enhanced,attach boxed title to top left={xshift=0.5cm,yshift=-2mm}
                }{exam}

\newtcbtheorem[auto counter,number within=section]{Remark}{Remark}{%
                lower separated=false,fonttitle=\bfseries,
                colback=MPIPink!10!white,colframe=MPIPink,
                colbacktitle=MPIPink, coltitle=white,
                enhanced,attach boxed title to top left={xshift=0.5cm,yshift=-2mm}
                }{rmk}


\newtcbtheorem[auto counter,number within=section]{Proof}{Proof}{%
                lower separated=false,fonttitle=\bfseries,
                colback=MPILivingCoral!10!white,colframe=MPILivingCoral,
                colbacktitle=MPILivingCoral, coltitle=white,
                enhanced,attach boxed title to top left={xshift=0.5cm,yshift=-2mm}
                }{pr}

\newtcbtheorem[auto counter,number within=section]{Solution}{Solution}{%
                lower separated=false,fonttitle=\bfseries,
                colback=MPIPacificCoast!10!white,colframe=MPIPacificCoast,
                colbacktitle=MPIPacificCoast, coltitle=white,
                enhanced,attach boxed title to top left={xshift=0.5cm,yshift=-2mm}
                }{sol}


\newenvironment{rmdexer}{
    \par\noindent
    \textbf{\color{MPIRed}Exercise} \itshape
}{\par}

\newenvironment{rmdsol}{
    \par\noindent
    \textbf{\color{MPIPacificCoast}Solution} \itshape
}{\par}


%......................................................................%
% add packages for title page

\definecolor{rcolor}{HTML}{2165B6}
\definecolor{rconsole}{HTML}{7E7E7E}

\newtcolorbox{rmdconsole}{
  enhanced,
  boxrule=0pt,
  colframe=rconsole,
  borderline ={0.3pt}{0pt}{rconsole},
  borderline west={4pt}{0pt}{rconsole},
  colback=rconsole!5!white,
  rounded corners
  }
\newtcolorbox{rmdcode}{
  enhanced,
  boxrule=0pt,
  colframe=rcolor,
  borderline ={0.3pt}{0pt}{rcolor},
  borderline west={4pt}{0pt}{rcolor},
  colback=rcolor!5!white,
  rounded corners
  }

\BeforeBeginEnvironment{verbatim}{\begin{rmdconsole}}
\AfterEndEnvironment{verbatim}{\end{rmdconsole}}

\BeforeBeginEnvironment{Highlighting}{\begin{rmdcode}}
\AfterEndEnvironment{Highlighting}{\end{rmdcode}}


\definecolor{shadecolor}{HTML}{ffffff}

%......................................................................%
% add packages for title page

\usepackage{tikz}

\usepackage[margin=1.5cm,includehead=true,includefoot=true,centering]{geometry}

% ----------------------------------------------------------------------------- %
%                                   Set Geometry                                %
% ----------------------------------------------------------------------------- %

\makeatletter
\def\parsecomma#1,#2\endparsecomma{\def\page@x{#1}\def\page@y{#2}}
\tikzdeclarecoordinatesystem{page}{
    \parsecomma#1\endparsecomma
    \pgfpointanchor{current page}{north east}
    % Save the upper right corner
    \pgf@xc=\pgf@x%
    \pgf@yc=\pgf@y%
    % save the lower left corner
    \pgfpointanchor{current page}{south west}
    \pgf@xb=\pgf@x%
    \pgf@yb=\pgf@y%
    % Transform to the correct placement
    \pgfmathparse{(\pgf@xc-\pgf@xb)/2.*\page@x+(\pgf@xc+\pgf@xb)/2.}
    \expandafter\pgf@x\expandafter=\pgfmathresult pt
    \pgfmathparse{(\pgf@yc-\pgf@yb)/2.*\page@y+(\pgf@yc+\pgf@yb)/2.}
    \expandafter\pgf@y\expandafter=\pgfmathresult pt
}
\makeatother


% ---------------------------------------------------------------------------- %
% header and footer
% ---------------------------------------------------------------------------- %

\usepackage{fancyhdr}
\pagestyle{fancy}
\fancyhf{}
\fancyhead[R]{\leftmark}
\fancyfoot[R]{\thepage}
\renewcommand{\headrulewidth}{0.5pt}
% \renewcommand{\footrulewidth}{0.25pt}


% TODO: Add header and footer options
% \lhead{}
% \chead{}
% \rhead{}
% \lfoot{}
% \cfoot{}
% \rfoot{}


% ---------------------------------------------------------------------------- %
% Banner Page Header and Footer Style



% ---------------------------------------------------------------------------- %
% Add Page Background


% ---------------------------------------------------------------------------- %
% Add Page Background Color

\usepackage{eso-pic}
\newcommand\BackPage{%
\begin{tikzpicture}[remember picture,overlay]
\fill[pageBackgroundColor](current page.south west) rectangle (\paperwidth,\paperheight);
\end{tikzpicture}%
}

%......................................................................%
% Remove Blank Page after Table of Contents and between chapter


%----------------------------------------------------------------------------------------
% Chapter Design
\usepackage{titlesec}

\titleformat{\section}[block]
  {\huge\color{chapterTitleColor}}
  {\filright \textbf{\thesection}\vspace{1ex}}{12pt}
  {}
  [\titlerule]

\titleformat{\subsection}[block]
  {\Large\color{chapterTitleColor}}
  {\filright \textbf{\thesubsection}\vspace{1ex}}{12pt}
  {}
  []



%----------------------------------------------------------------------------------------
% Remove page number in toc and strange white first page



%......................................................................%
%
%               End of Modifications
%
%......................................................................%


\begin{document}



% \makeatletter
% \newcommand\titlestyle{\normalfont\Huge\spaceskip4mm}
% \makeatother

%......................................................................%
%               Add Titlepage
%......................................................................%


\begin{titlepage}

%......................................................................%
%                         Max-Planck Society Design

\begin{tikzpicture}[remember picture,overlay]



% add white rule



%......................................................................%


%......................................................................%
%                         FullCover Color Page Design

%......................................................................%


\node[inner sep=0pt] at (current page.center){\includegraphics[width=\paperwidth,height=\paperheight]{src/img/background.eps}};


% add main logo % TODO: add else
\node[inner sep=0pt] at (page cs:0.672,0.795){};
% add secondary logo % TODO: add else
\node[inner sep=0pt] at (page cs:0.0+\logoSecondaryHjust,0.0+\logoSecondaryVjust){\includegraphics[height=\logoSecondarySize\paperheight]{src/icon/tubingen.eps}};

% add title and subtitle
% TODO: use bodoni font in title
% \node[below,text width=\paperwidth,font=\color{titlepageTextColor}] at (page cs:0.15+\titleHjust,0.57+\titleVjust) {
\node[below,text width=\paperwidth,font=\color{titlepageTextColor}] at (page cs:0.0+\titleHjust,0.0+\titleVjust) {

    \spaceskip4mm{\bfseries \Huge{Causal Learning}}
  \vspace{0.3cm}
  
    \huge{Tubingen University}
  \vspace{0.3cm}
  
  % add bodoni font to date
  
  \vspace{0.6cm}
  
  };

\node[below,text width=\paperwidth,font=\color{titlepageTextColor}] at (page cs:0.0+\authorHjust,0.0+\authorVjust) {
    \huge{\textsf{\textcolor{titlepageAuthorTextColor}{Ahmad Ehyaei}}}
  \vspace{0.3cm}
  };

\end{tikzpicture}
\end{titlepage}
% \restoregeometry

% end design titlepage
%......................................................................%

%......................................................................%
% Add Page Background

\ClearShipoutPicture
\AddToShipoutPicture{\BackPage}


% add these lines for simple report template
% end add



% add from eisvogel template



% Add Table of Contents




\hypertarget{xicor}{%
\section{XICOR}\label{xicor}}

\begin{Definition}{Chatterjee Correlation}
Given random variables \(X, Y\), where is \(Y\) is not a constant,
Chatterjee correlation \(\xi\) is defined as
\[\xi(X, Y) = \frac{\int Var(\mathbb{E}(1_{\{Y \geq t\}}|X)) d\mu(t)}{\int Var(1_{\{Y \geq t\}}) d\mu(t)},\]
where \(\mu\) is the law of \(Y\).

\end{Definition}

Let \(\{(X_i, Y_i)\}_{i = 1}^n\) be i.i.d. pairs following the same
distribution as \((X, Y)\). Rearrange the data as
\((X_{(1)}, Y_{(1)}), \dots, (X_{(n)}, Y_{(n)})\) such that
\(X_{(1)} < \dots < X_{(n)}\). Let \(r_i\) be the rank of \(Y_{(i)}\),
i.e.~the number of \(j\) such that \(Y_{(j)} \leq Y_{(i)}\). Then the
correlation coefficient \(\xi_n\) is defined to be
\[\xi_n(X, Y) := 1-\frac{3\sum_{i=1}^{n-1} |r_{i+1} - r_i|}{n^2-1}.\]
The properties of Chatterjee's correlation coefficient are:

\begin{itemize}
\item $\xi(X, Y) \in [0, 1]$
\item $\xi(X, Y) = 0$ if and only if $X$ and $Y$ are independent.
\item $\xi(X, Y) = 1$ if and only if atleast one of $X$ and $Y$ is a measurable function of the other.
\item $\xi$ is not symmetric in $X, Y$. This is intentional and useful as we might want to study if $Y$ is a measurable function of $X$, or $X$ is a measurable function of $Y$. To get a symmetric coefficient, it suffices to consider $\max(\xi(X, Y), \xi(Y, X))$.
\item $\xi_n$ is based on ranks, and for the same reason, it can be computed in $O(n\log n)$.
\end{itemize}

\begin{Theorem}{}
If \(Y\) is not almost surely a constant, then as
\(n \rightarrow \infty\), \(\xi_n(X, Y)\) converges almost surely to
\(\xi(X, Y)\).

\end{Theorem}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{n }\OtherTok{=} \DecValTok{100000}
\NormalTok{x }\OtherTok{\textless{}{-}} \FunctionTok{rnorm}\NormalTok{(n)}
\NormalTok{z }\OtherTok{\textless{}{-}} \FunctionTok{rnorm}\NormalTok{(n)}
\NormalTok{y }\OtherTok{=}\NormalTok{ x}\SpecialCharTok{\^{}}\DecValTok{2{-}2}\SpecialCharTok{*}\FunctionTok{sin}\NormalTok{(x)}\SpecialCharTok{\^{}}\DecValTok{2}\SpecialCharTok{+}\DecValTok{1}
\NormalTok{chatterjee }\OtherTok{=} \FunctionTok{xicor}\NormalTok{(x, y, }\AttributeTok{pvalue=}\ConstantTok{TRUE}\NormalTok{)}\SpecialCharTok{$}\NormalTok{x }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{round}\NormalTok{(}\DecValTok{3}\NormalTok{)}
\NormalTok{paerson }\OtherTok{=} \FunctionTok{cor}\NormalTok{(x, y) }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{round}\NormalTok{(}\DecValTok{3}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=0.7\linewidth]{figure/unnamed-chunk-3-1} \end{center}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{alpha }\OtherTok{=} \FunctionTok{seq}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\FloatTok{0.001}\NormalTok{)}
\NormalTok{cor\_table }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}\AttributeTok{alpha =}\NormalTok{ alpha, }\AttributeTok{chatterjee =} \DecValTok{0}\NormalTok{, }\AttributeTok{paerson =} \DecValTok{0}\NormalTok{)}
\ControlFlowTok{for}\NormalTok{(i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\FunctionTok{length}\NormalTok{(alpha))\{}
\NormalTok{y }\OtherTok{=}\NormalTok{ alpha[i]}\SpecialCharTok{*}\NormalTok{x }\SpecialCharTok{+}\NormalTok{ (}\DecValTok{1}\SpecialCharTok{{-}}\NormalTok{alpha[i])}\SpecialCharTok{*}\NormalTok{z}
\NormalTok{cor\_table}\SpecialCharTok{$}\NormalTok{chatterjee[i] }\OtherTok{=} \FunctionTok{xicor}\NormalTok{(x, y, }\AttributeTok{pvalue=}\ConstantTok{TRUE}\NormalTok{)}\SpecialCharTok{$}\NormalTok{x }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{round}\NormalTok{(}\DecValTok{3}\NormalTok{)}
\NormalTok{cor\_table}\SpecialCharTok{$}\NormalTok{paerson[i] }\OtherTok{=} \FunctionTok{cor}\NormalTok{(x, y) }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{round}\NormalTok{(}\DecValTok{3}\NormalTok{)}
\NormalTok{\}}
\NormalTok{cor\_table}\SpecialCharTok{$}\NormalTok{correction\_term }\OtherTok{=}\NormalTok{ alpha}\SpecialCharTok{/}\NormalTok{(}\FunctionTok{sqrt}\NormalTok{(alpha}\SpecialCharTok{\^{}}\DecValTok{2} \SpecialCharTok{+}\NormalTok{ (}\DecValTok{1}\SpecialCharTok{{-}}\NormalTok{alpha)}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{))}
\FunctionTok{write\_rds}\NormalTok{(cor\_table,}\StringTok{"data/cor\_table.rds"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{sim }\OtherTok{=} \FunctionTok{read\_rds}\NormalTok{(}\StringTok{"data/cor\_table.rds"}\NormalTok{)}
\NormalTok{colors }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"chatterjee"} \OtherTok{=} \StringTok{"blue"}\NormalTok{, }\StringTok{"paerson"} \OtherTok{=} \StringTok{"red"}\NormalTok{)}

\FunctionTok{ggplot}\NormalTok{()}\SpecialCharTok{+}
  \FunctionTok{geom\_line}\NormalTok{(}\AttributeTok{data =}\NormalTok{ sim, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ alpha, }\AttributeTok{y =}\NormalTok{ chatterjee}\SpecialCharTok{/}\NormalTok{correction\_term, }\AttributeTok{color =} \StringTok{"chatterjee"}\NormalTok{))}\SpecialCharTok{+}
  \FunctionTok{geom\_line}\NormalTok{(}\AttributeTok{data =}\NormalTok{ sim, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ alpha, }\AttributeTok{y =}\NormalTok{ paerson}\SpecialCharTok{/}\NormalTok{correction\_term, }\AttributeTok{color =} \StringTok{"paerson"}\NormalTok{))}\SpecialCharTok{+}
  \FunctionTok{theme\_scientific}\NormalTok{()}\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{y =} \StringTok{"Correlation"}\NormalTok{, }\AttributeTok{color =} \ConstantTok{NULL}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{scale\_color\_manual}\NormalTok{(}\AttributeTok{values =}\NormalTok{ colors)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{figure/unnamed-chunk-5-1} \end{center}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{alpha }\OtherTok{=} \FunctionTok{seq}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\FloatTok{0.001}\NormalTok{)}
\NormalTok{cor\_table }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}\AttributeTok{alpha =}\NormalTok{ alpha, }\AttributeTok{chatterjee =} \DecValTok{0}\NormalTok{, }\AttributeTok{paerson =} \DecValTok{0}\NormalTok{)}

\ControlFlowTok{for}\NormalTok{(i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\FunctionTok{length}\NormalTok{(alpha))\{}
\NormalTok{y }\OtherTok{=}\NormalTok{ alpha[i]}\SpecialCharTok{*}\NormalTok{x}\SpecialCharTok{\^{}}\DecValTok{2} \SpecialCharTok{+}\NormalTok{ (}\DecValTok{1}\SpecialCharTok{{-}}\NormalTok{alpha[i])}\SpecialCharTok{*}\NormalTok{z}\SpecialCharTok{\^{}}\DecValTok{2}
\NormalTok{cor\_table}\SpecialCharTok{$}\NormalTok{chatterjee[i] }\OtherTok{=} \FunctionTok{xicor}\NormalTok{(x, y, }\AttributeTok{pvalue=}\ConstantTok{TRUE}\NormalTok{)}\SpecialCharTok{$}\NormalTok{x }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{round}\NormalTok{(}\DecValTok{3}\NormalTok{)}
\NormalTok{cor\_table}\SpecialCharTok{$}\NormalTok{paerson[i] }\OtherTok{=} \FunctionTok{cor}\NormalTok{(x, y) }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{round}\NormalTok{(}\DecValTok{3}\NormalTok{)}
\NormalTok{\}}
\NormalTok{cor\_table}\SpecialCharTok{$}\NormalTok{correction\_term }\OtherTok{=}\NormalTok{ alpha}\SpecialCharTok{/}\NormalTok{(}\FunctionTok{sqrt}\NormalTok{(alpha}\SpecialCharTok{\^{}}\DecValTok{2} \SpecialCharTok{+}\NormalTok{ (}\DecValTok{1}\SpecialCharTok{{-}}\NormalTok{alpha)}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{))}
\FunctionTok{write\_rds}\NormalTok{(cor\_table,}\StringTok{"data/cor\_table\_2.rds"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{sim }\OtherTok{=} \FunctionTok{read\_rds}\NormalTok{(}\StringTok{"data/cor\_table\_2.rds"}\NormalTok{)}
\NormalTok{colors }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"chatterjee"} \OtherTok{=} \StringTok{"blue"}\NormalTok{, }\StringTok{"paerson"} \OtherTok{=} \StringTok{"red"}\NormalTok{)}

\FunctionTok{ggplot}\NormalTok{()}\SpecialCharTok{+}
  \FunctionTok{geom\_line}\NormalTok{(}\AttributeTok{data =}\NormalTok{ sim, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ alpha, }\AttributeTok{y =}\NormalTok{ chatterjee, }\AttributeTok{color =} \StringTok{"chatterjee"}\NormalTok{))}\SpecialCharTok{+}
  \FunctionTok{geom\_line}\NormalTok{(}\AttributeTok{data =}\NormalTok{ sim, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ alpha, }\AttributeTok{y =}\NormalTok{ paerson, }\AttributeTok{color =} \StringTok{"paerson"}\NormalTok{))}\SpecialCharTok{+}
  \FunctionTok{theme\_scientific}\NormalTok{()}\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{y =} \StringTok{"Correlation"}\NormalTok{, }\AttributeTok{color =} \ConstantTok{NULL}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{scale\_color\_manual}\NormalTok{(}\AttributeTok{values =}\NormalTok{ colors)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{figure/unnamed-chunk-7-1} \end{center}

\hypertarget{estimating-large-causal-polytree-skeletons-from-small-samples}{%
\section{ESTIMATING LARGE CAUSAL POLYTREE SKELETONS FROM SMALL
SAMPLES}\label{estimating-large-causal-polytree-skeletons-from-small-samples}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{w }\OtherTok{=} \FunctionTok{bernouli\_dag}\NormalTok{(}\DecValTok{10}\NormalTok{, }\FloatTok{0.4}\NormalTok{)}

\CommentTok{\# 2. Plot Dag Related To Adjacency Matrix}
\NormalTok{dag }\OtherTok{\textless{}{-}} \FunctionTok{adjacency\_to\_dag}\NormalTok{(w)}
\NormalTok{p\_graph }\OtherTok{\textless{}{-}} \FunctionTok{ggdag}\NormalTok{(dag, }\AttributeTok{layout =} \StringTok{"circle"}\NormalTok{) }\SpecialCharTok{+} \FunctionTok{theme\_dag}\NormalTok{()}

\CommentTok{\# 3. Generate SCM corresponding to Noise and Adjacency Matrix}
\NormalTok{scm }\OtherTok{\textless{}{-}} \FunctionTok{lin\_scm}\NormalTok{(}\AttributeTok{w =}\NormalTok{ w, }\AttributeTok{noise =}\NormalTok{ normal\_noise, }\AttributeTok{n =} \DecValTok{10000}\NormalTok{)}

\CommentTok{\# 4. Estimate Tree by Chatterjee Algorithms}
\NormalTok{xi }\OtherTok{\textless{}{-}} \FunctionTok{cor\_mat}\NormalTok{(}\FunctionTok{normal\_mat}\NormalTok{(scm))}

\CommentTok{\# 5. plot the correlation matrix VS Adjacency}
\NormalTok{p\_true }\OtherTok{\textless{}{-}} \FunctionTok{cor\_adj\_plot}\NormalTok{(xi, w)}

\CommentTok{\# 6. Estimate Tree}
\NormalTok{e }\OtherTok{\textless{}{-}} \FunctionTok{estimate\_tree}\NormalTok{(xi)}

\NormalTok{e\_dag }\OtherTok{\textless{}{-}} \FunctionTok{adjacency\_to\_dag}\NormalTok{(e)}
\NormalTok{e\_graph }\OtherTok{\textless{}{-}} \FunctionTok{ggdag}\NormalTok{(e\_dag, }\AttributeTok{layout =} \StringTok{"circle"}\NormalTok{) }\SpecialCharTok{+} \FunctionTok{theme\_dag}\NormalTok{()}

\CommentTok{\# 7. find the difference between true and estimated graph}
\NormalTok{p\_fault }\OtherTok{\textless{}{-}} \FunctionTok{cor\_fault\_plot}\NormalTok{(xi, w, e)}


\NormalTok{p }\OtherTok{\textless{}{-}} \FunctionTok{ggarrange}\NormalTok{(p\_graph, p\_true, p\_fault,e\_graph,}
          \AttributeTok{labels =} \FunctionTok{c}\NormalTok{(}\StringTok{"A"}\NormalTok{, }\StringTok{"B"}\NormalTok{, }\StringTok{"C"}\NormalTok{,}\StringTok{"D"}\NormalTok{),}
          \AttributeTok{ncol =} \DecValTok{2}\NormalTok{, }\AttributeTok{nrow =} \DecValTok{2}\NormalTok{)}
\FunctionTok{ggsave}\NormalTok{(}\StringTok{"plots/graph.pdf"}\NormalTok{, p, }\AttributeTok{device =}\NormalTok{ cairo\_pdf,}\AttributeTok{width =} \DecValTok{30}\NormalTok{, }\AttributeTok{height =} \DecValTok{30}\NormalTok{, }\AttributeTok{unit =}\StringTok{"cm"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}
\includegraphics[width =\textwidth]{plots/graph.pdf}
\end{figure}

\begin{verbatim}
[1] 0.2980773
\end{verbatim}

\begin{verbatim}
[1] 0.3261963
\end{verbatim}

\begin{verbatim}
[1] 0.1393531
\end{verbatim}

\begin{verbatim}
[1] 0.1720412
\end{verbatim}

\#\url{https://igraph.org/r/doc/isomorphic.html}

In the below work the corelation extend to multivariate r.v. and use the
nearest neighbor Azadkia-Chatterjee's correlation coefficient adapts to
manifold data Fang Hanâˆ— and Zhihan Huang

\end{document}
